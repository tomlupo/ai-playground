<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAL Strategies Reverse Engineering Report</title>
    <style>
        :root {
            --bg: #0d1117;
            --card: #161b22;
            --border: #30363d;
            --text: #c9d1d9;
            --text-muted: #8b949e;
            --accent: #58a6ff;
            --green: #3fb950;
            --red: #f85149;
            --orange: #d29922;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 { color: var(--accent); margin-bottom: 0.5rem; font-size: 2rem; }
        h2 { color: var(--text); margin: 2rem 0 1rem; font-size: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; }
        h3 { color: var(--text-muted); margin: 1.5rem 0 0.75rem; font-size: 1.1rem; }
        .subtitle { color: var(--text-muted); margin-bottom: 2rem; }
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .metric-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem 1.25rem;
        }
        .metric-card h4 {
            color: var(--text-muted);
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        .metric-value {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--accent);
        }
        .metric-value.green { color: var(--green); }
        .metric-value.red { color: var(--red); }
        .metric-value.orange { color: var(--orange); }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }
        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        th {
            background: var(--bg);
            color: var(--text-muted);
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
        }
        tr:hover { background: rgba(56, 139, 253, 0.1); }
        .match { color: var(--green); font-weight: bold; }
        .no-match { color: var(--red); }
        code {
            background: var(--bg);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'SFMono-Regular', Consolas, monospace;
            font-size: 0.85em;
        }
        pre {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        pre code { padding: 0; background: none; }
        .tag {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-right: 0.5rem;
        }
        .tag-mr { background: rgba(56, 139, 253, 0.2); color: var(--accent); }
        .tag-regime { background: rgba(63, 185, 80, 0.2); color: var(--green); }
        ul { margin: 1rem 0 1rem 1.5rem; }
        li { margin-bottom: 0.5rem; }
        .insight-box {
            background: rgba(210, 153, 34, 0.1);
            border-left: 4px solid var(--orange);
            padding: 1rem 1.25rem;
            margin: 1.5rem 0;
            border-radius: 0 6px 6px 0;
        }
        .footer {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 0.85rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>PAL Strategies Reverse Engineering</h1>
    <p class="subtitle">Attempt to replicate Price Action Lab trading strategies from published metrics</p>

    <div class="summary-grid">
        <div class="metric-card">
            <h4>Strategies Tested</h4>
            <div class="metric-value">3</div>
        </div>
        <div class="metric-card">
            <h4>Best Achieved Sharpe</h4>
            <div class="metric-value orange">0.68</div>
        </div>
        <div class="metric-card">
            <h4>Target Match Rate</h4>
            <div class="metric-value red">0%</div>
        </div>
        <div class="metric-card">
            <h4>Avg Target Gap</h4>
            <div class="metric-value">~40%</div>
        </div>
    </div>

    <h2>Executive Summary</h2>
    <div class="card">
        <p>This project attempted to reverse-engineer three PAL trading strategies based solely on their published performance metrics. Using systematic parameter optimization across multiple signal generation approaches, the achieved results capture <strong>40-70% of the target Sharpe ratios</strong>.</p>

        <div class="insight-box">
            <strong>Key Insight:</strong> Simple mean-reversion rules consistently generate positive returns but struggle to achieve the high risk-adjusted returns PAL reports. The gap suggests PAL uses proprietary indicator ensembles, dynamic position sizing, or walk-forward optimization techniques not captured by single-indicator approaches.
        </div>
    </div>

    <h2>Results Comparison</h2>

    <h3>Train Period (2005-2020)</h3>
    <div class="card">
        <table>
            <thead>
                <tr>
                    <th>Strategy</th>
                    <th>Type</th>
                    <th>Achieved CAGR</th>
                    <th>Achieved DD</th>
                    <th>Achieved Sharpe</th>
                    <th>Target</th>
                    <th>Match</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>ETFMR</strong></td>
                    <td><span class="tag tag-mr">Mean-Reversion</span></td>
                    <td>7.3%</td>
                    <td>-21.6%</td>
                    <td>0.49</td>
                    <td>10.0% / -22.9% / 0.82</td>
                    <td class="no-match">✗</td>
                </tr>
                <tr>
                    <td><strong>B2S2ETF</strong></td>
                    <td><span class="tag tag-mr">Mean-Reversion</span></td>
                    <td>6.5%</td>
                    <td>-24.7%</td>
                    <td>0.36</td>
                    <td>9.1% / -30.6% / 0.63</td>
                    <td class="no-match">✗</td>
                </tr>
                <tr>
                    <td><strong>MRMOM</strong></td>
                    <td><span class="tag tag-regime">Regime Switching</span></td>
                    <td>7.4%</td>
                    <td>-17.2%</td>
                    <td>0.68</td>
                    <td>10.3% / -16.8% / 1.15</td>
                    <td class="no-match">✗</td>
                </tr>
            </tbody>
        </table>
    </div>

    <h3>Test Period (2021-2026)</h3>
    <div class="card">
        <table>
            <thead>
                <tr>
                    <th>Strategy</th>
                    <th>CAGR</th>
                    <th>Max DD</th>
                    <th>Sharpe</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>ETFMR</strong></td>
                    <td>5.2%</td>
                    <td>-13.3%</td>
                    <td>0.34</td>
                    <td>Lower performance in recent period</td>
                </tr>
                <tr>
                    <td><strong>B2S2ETF</strong></td>
                    <td>9.1%</td>
                    <td>-18.3%</td>
                    <td>0.56</td>
                    <td>Better in volatile markets</td>
                </tr>
                <tr>
                    <td><strong>MRMOM</strong></td>
                    <td>5.7%</td>
                    <td>-15.5%</td>
                    <td>0.42</td>
                    <td>Stable drawdown control</td>
                </tr>
            </tbody>
        </table>
    </div>

    <h2>Strategy Details</h2>

    <h3>ETFMR (ETF Mean-Reversion)</h3>
    <div class="card">
        <p><strong>Assets:</strong> SPY, QQQ (equal-weighted)</p>
        <p><strong>Hypothesis:</strong> RSI-based mean-reversion with IBS confirmation</p>

        <h4 style="margin-top: 1rem; color: var(--text-muted);">Best Parameters</h4>
        <pre><code>{
    "rsi_period": 2,
    "rsi_entry": 20,
    "ibs_entry": 0.2,
    "rsi_exit": 55
}</code></pre>

        <h4 style="margin-top: 1rem; color: var(--text-muted);">Logic</h4>
        <ul>
            <li><strong>Entry:</strong> RSI-2 &lt; 20 AND IBS &lt; 0.2 (both indicators oversold)</li>
            <li><strong>Exit:</strong> RSI-2 &gt; 55 (recovery signal)</li>
            <li><strong>Position:</strong> Equal-weight SPY and QQQ when signal fires</li>
        </ul>
    </div>

    <h3>B2S2ETF (Buy 2 Sell 2)</h3>
    <div class="card">
        <p><strong>Assets:</strong> SPY only</p>
        <p><strong>Hypothesis:</strong> "Buy after 2 down, hold for fixed period" pattern</p>

        <h4 style="margin-top: 1rem; color: var(--text-muted);">Best Parameters</h4>
        <pre><code>{
    "down_days": 2,
    "rsi_period": 2,
    "rsi_entry": 20,
    "hold_days": 5
}</code></pre>

        <h4 style="margin-top: 1rem; color: var(--text-muted);">Logic</h4>
        <ul>
            <li><strong>Entry:</strong> 2 consecutive down days AND RSI-2 &lt; 20</li>
            <li><strong>Exit:</strong> After 5 trading days (fixed holding period)</li>
            <li><strong>Rationale:</strong> Short-term oversold bounce with time-based exit</li>
        </ul>
    </div>

    <h3>MRMOM (MR/Momentum Regime)</h3>
    <div class="card">
        <p><strong>Assets:</strong> SPY, QQQ, TLT, GLD (4-asset rotation)</p>
        <p><strong>Hypothesis:</strong> Use Momersion indicator to switch between MR and momentum rules</p>

        <h4 style="margin-top: 1rem; color: var(--text-muted);">Best Parameters</h4>
        <pre><code>{
    "mom_lookback": 252,
    "mom_threshold": 55,
    "rsi_period": 2,
    "mr_rsi_entry": 20,
    "hold_days": 5
}</code></pre>

        <h4 style="margin-top: 1rem; color: var(--text-muted);">Logic</h4>
        <ul>
            <li><strong>MR Regime (Momersion &lt; 55):</strong> RSI mean-reversion on SPY/QQQ</li>
            <li><strong>MOM Regime (Momersion &ge; 55):</strong> Trend-following (price &gt; 200-day SMA)</li>
            <li><strong>TLT:</strong> Risk-off allocation in MR regime or weak equity momentum</li>
            <li><strong>GLD:</strong> Volatility hedge when SPY vol &gt; 20%</li>
        </ul>
    </div>

    <h2>What PAL Likely Does Differently</h2>
    <div class="card">
        <ol style="margin-left: 1.5rem;">
            <li><strong>Indicator Ensembles:</strong> Multiple indicators voting on entry/exit decisions</li>
            <li><strong>Walk-Forward Optimization:</strong> Parameters adjusted over rolling windows to prevent overfitting</li>
            <li><strong>Volatility-Adjusted Sizing:</strong> Position size inversely proportional to recent volatility</li>
            <li><strong>Correlation Filters:</strong> Avoiding trades when cross-asset correlation is extreme</li>
            <li><strong>Transaction Cost Optimization:</strong> Minimizing turnover while capturing alpha</li>
            <li><strong>Proprietary Indicators:</strong> Custom indicators beyond standard technical analysis</li>
        </ol>
    </div>

    <h2>Lessons Learned</h2>
    <div class="card">
        <ul>
            <li>Simple mean-reversion consistently generates <strong>positive but modest returns</strong></li>
            <li>Achieving Sharpe &gt; 1.0 requires more sophisticated approaches than single-indicator rules</li>
            <li>Regime detection (Momersion) helps with <strong>drawdown control</strong> but doesn't fully explain performance</li>
            <li>The test period (2021-2026) often shows better metrics, suggesting strategies benefit from volatile markets</li>
            <li>The <strong>~40% gap</strong> between achieved and target Sharpe ratios is consistent across strategies</li>
        </ul>
    </div>

    <h2>Files & Code</h2>
    <div class="card">
        <table>
            <thead>
                <tr>
                    <th>File</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><code>base.py</code></td><td>Shared backtest infrastructure and metrics</td></tr>
                <tr><td><code>etfmr.py</code></td><td>ETFMR strategy with 7 signal variants</td></tr>
                <tr><td><code>b2s2etf.py</code></td><td>B2S2ETF strategy with 6 signal variants</td></tr>
                <tr><td><code>mrmom.py</code></td><td>MRMOM regime-switching strategy</td></tr>
                <tr><td><code>run_all.py</code></td><td>Comparison report generator</td></tr>
            </tbody>
        </table>
    </div>

    <div class="footer">
        Generated: February 5, 2026 | PAL Strategies Reverse Engineering Project
    </div>
</body>
</html>
